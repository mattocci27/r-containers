# NOTE: THIS SINGULARITY DEFINITION FILE IS GENERATED VIA "update.py"
BootStrap: docker
From: rocker/geospatial:4.2.0



%apprun R
  exec R "${@}"

%apprun Rscript
  exec Rscript "${@}"

%runscript
  exec R "${@}"

%post
    DEBIAN_FRONTEND=noninteractive

    apt-get update -q -y \
    && apt-get install --no-install-recommends --fix-missing -y \
        default-libmysqlclient-dev \
        libcairo2-dev \
        libcurl4-openssl-dev \
        libgit2-dev \
        libglpk-dev \
        libpq-dev \
        libpython3-dev \
        libsasl2-dev \
        libsqlite3-dev \
        libssh2-1-dev \
        libxml2-dev \
        libxt-dev \
        libxtst6 \
        python3-dev \
        python3-pip \
        unixodbc-dev \
        latexdiff \
        gosu \
    && apt-get autoremove -y \
    && apt-get clean all




   # pip3 config set global.index-url https://pypi.tuna.tsinghua.edu.cn/simple \
  pip3 install --upgrade setuptools \
    && pip3 install --default-timeout=100 -U radian




    yes | apt-get install ttf-mscorefonts-installer \
        && fc-cache -f \
        && apt-get autoremove -y \
        && apt-get autoclean -y

    install2.r -n -2 --skipinstalled --error \
      extrafont

    R -e 'remotes::install_version("Rttf2pt1", version = "1.3.8")'
    R -e 'extrafont::font_import(prompt = FALSE)'
